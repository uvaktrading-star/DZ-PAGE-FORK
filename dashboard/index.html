<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ZANTA-MD | Control Panel</title>
    
    <script type='text/javascript' src='//pl28408717.effectivegatecpm.com/00/6e/30/006e304b5ab96fb51a608263d55d1a7e.js'></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">

    <style>
        body { font-family: 'Space Grotesk', sans-serif; background: #0b0f1a; color: white; overflow-x: hidden; }
        .stars-container { position: fixed; inset: 0; z-index: 0; background: radial-gradient(circle at center, #111827 0%, #000000 100%); }
        .star { position: absolute; background: #3b82f6; border-radius: 50%; opacity: 0.4; animation: move linear infinite; }
        @keyframes move { from { transform: translateY(100vh); opacity: 0; } to { transform: translateY(-10vh); opacity: 0.6; } }
        .glass-box { background: rgba(30, 41, 59, 0.4); backdrop-filter: blur(25px); border: 1px solid rgba(255, 255, 255, 0.05); border-radius: 2.5rem; box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5); }
        .setting-card { background: rgba(15, 23, 42, 0.5); border: 1px solid rgba(255, 255, 255, 0.03); transition: all 0.3s ease; }
        .setting-card:hover { border-color: rgba(59, 130, 246, 0.3); transform: translateY(-2px); }
        .input-glow:focus { border-color: #3b82f6; box-shadow: 0 0 15px rgba(59, 130, 246, 0.2); outline: none; }
        .switch { position: relative; display: inline-block; width: 44px; height: 24px; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; inset: 0; background-color: #334155; transition: .4s; border-radius: 34px; }
        .slider:before { position: absolute; content: ""; height: 18px; width: 18px; left: 3px; bottom: 3px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked + .slider { background-color: #3b82f6; }
        input:checked + .slider:before { transform: translateX(20px); }

        #notification-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 9999;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .toast {
            background: rgba(30, 41, 59, 0.9);
            backdrop-filter: blur(10px);
            border-left: 4px solid #3b82f6;
            color: white;
            padding: 16px 24px;
            border-radius: 12px;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            gap: 12px;
            transform: translateX(120%);
            transition: transform 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }
        .toast.active { transform: translateX(0); }
        .toast-info { border-color: #3b82f6; }
        .toast-success { border-color: #10b981; }
        .toast-error { border-color: #ef4444; }
    </style>
</head>
<body class="min-h-screen py-12 px-4">

    <div class="stars-container" id="stars"></div>

    <div id="notification-container"></div>

    <main class="relative z-10 w-full max-w-2xl mx-auto mb-24">
        
        <div class="text-center mb-10" data-aos="fade-down">
            <div class="inline-block p-4 rounded-3xl bg-blue-600/10 border border-blue-500/20 mb-4">
                <img src="https://github.com/Akashkavindu/ZANTA_MD/blob/main/images/WhatsApp%20Image%202025-12-29%20at%209.28.43%20AM.jpeg?raw=true" 
                     class="w-16 h-16 rounded-2xl shadow-xl shadow-blue-500/20" alt="Logo">
            </div>
            <h1 class="text-3xl font-black tracking-tighter uppercase">Control <span class="text-blue-500">Panel</span></h1>
            <p class="text-slate-500 text-[10px] font-bold tracking-[0.4em] uppercase">Advanced Instance Manager</p>
        </div>

        <div class="glass-box p-6 md:p-10 space-y-8" data-aos="fade-up">
            
            <div>
                <h3 class="text-xs font-black text-blue-500 uppercase tracking-[0.2em] mb-6 flex items-center">
                    <i class="fa-solid fa-gear mr-2"></i> General Settings
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="space-y-1">
                        <label class="text-[10px] font-bold text-slate-500 uppercase ml-2">Bot Name</label>
                        <input type="text" id="botName" class="w-full bg-slate-900/50 border border-white/5 rounded-2xl px-4 py-3 text-sm input-glow">
                    </div>
                    <div class="space-y-1">
                        <label class="text-[10px] font-bold text-slate-500 uppercase ml-2">Owner Name</label>
                        <input type="text" id="ownerName" class="w-full bg-slate-900/50 border border-white/5 rounded-2xl px-4 py-3 text-sm input-glow">
                    </div>
                    <div class="space-y-1">
                        <label class="text-[10px] font-bold text-slate-500 uppercase ml-2">Dashboard Password</label>
                        <input type="password" id="password" class="w-full bg-slate-900/50 border border-white/5 rounded-2xl px-4 py-3 text-sm input-glow">
                    </div>
                    <div class="space-y-1">
                        <label class="text-[10px] font-bold text-slate-500 uppercase ml-2">Prefix</label>
                        <input type="text" id="prefix" maxlength="1" class="w-full bg-slate-900/50 border border-white/5 rounded-2xl px-4 py-3 text-sm input-glow">
                    </div>
                    <div class="md:col-span-2 space-y-1">
                        <label class="text-[10px] font-bold text-slate-500 uppercase ml-2">Work Type</label>
                        <select id="workType" class="w-full bg-slate-900 border border-white/5 rounded-2xl px-4 py-3 text-sm input-glow">
                            <option value="public">Public Mode</option>
                            <option value="private">Private Mode</option>
                        </select>
                    </div>
                </div>
            </div>

            <div>
                <h3 class="text-xs font-black text-blue-500 uppercase tracking-[0.2em] mb-6 flex items-center">
                    <i class="fa-solid fa-bolt mr-2"></i> Automations
                </h3>
                <div class="grid grid-cols-1 gap-3">
                    <div class="setting-card p-4 rounded-2xl flex items-center justify-between">
                        <div><h4 class="text-sm font-bold">Always Online</h4><p class="text-[10px] text-slate-500">Keep bot status active 24/7</p></div>
                        <label class="switch"><input type="checkbox" id="alwaysOnline"><span class="slider"></span></label>
                    </div>
                    <div class="setting-card p-4 rounded-2xl flex items-center justify-between">
                        <div><h4 class="text-sm font-bold">Auto Read Msg</h4><p class="text-[10px] text-slate-500">Mark all messages as seen</p></div>
                        <label class="switch"><input type="checkbox" id="autoRead"><span class="slider"></span></label>
                    </div>
                    <div class="setting-card p-4 rounded-2xl flex items-center justify-between">
                        <div><h4 class="text-sm font-bold">Read Commands</h4><p class="text-[10px] text-slate-500">Mark only commands as read</p></div>
                        <label class="switch"><input type="checkbox" id="readCmd"><span class="slider"></span></label>
                    </div>
                    <div class="setting-card p-4 rounded-2xl flex items-center justify-between">
                        <div><h4 class="text-sm font-bold">Auto Status React</h4><p class="text-[10px] text-slate-500">React to status updates</p></div>
                        <label class="switch"><input type="checkbox" id="autoStatusReact"><span class="slider"></span></label>
                    </div>
                    <div class="setting-card p-4 rounded-2xl flex items-center justify-between">
                        <div><h4 class="text-sm font-bold">Auto Status Seen</h4><p class="text-[10px] text-slate-500">View status updates automatically</p></div>
                        <label class="switch"><input type="checkbox" id="autoStatusSeen"><span class="slider"></span></label>
                    </div>
                    <div class="setting-card p-4 rounded-2xl flex items-center justify-between">
                        <div><h4 class="text-sm font-bold">Auto Typing</h4><p class="text-[10px] text-slate-500">Show typing indicator</p></div>
                        <label class="switch"><input type="checkbox" id="autoTyping"><span class="slider"></span></label>
                    </div>
                    <div class="setting-card p-4 rounded-2xl flex items-center justify-between">
                        <div><h4 class="text-sm font-bold">Auto Voice</h4><p class="text-[10px] text-slate-500">Enable voice response mode</p></div>
                        <label class="switch"><input type="checkbox" id="autoVoice"><span class="slider"></span></label>
                    </div>
                    <div class="setting-card p-4 rounded-2xl flex items-center justify-between">
                        <div><h4 class="text-sm font-bold">Connection Msg</h4><p class="text-[10px] text-slate-500">Send startup notification</p></div>
                        <label class="switch"><input type="checkbox" id="connectionMsg"><span class="slider"></span></label>
                    </div>
                    <div class="setting-card p-4 rounded-2xl flex items-center justify-between">
                        <div><h4 class="text-sm font-bold">Buttons Mode</h4><p class="text-[10px] text-slate-500">Enable button UI in messages</p></div>
                        <label class="switch"><input type="checkbox" id="buttons"><span class="slider"></span></label>
                    </div>
                    <div class="setting-card p-4 rounded-2xl flex items-center justify-between">
                        <div><h4 class="text-sm font-bold">Anti Delete</h4><p class="text-[10px] text-slate-500">Prevent message deletion for everyone</p></div>
                        <label class="switch"><input type="checkbox" id="antidelete"><span class="slider"></span></label>
                    </div>
                </div>
            </div>

            <div>
                <h3 class="text-xs font-black text-blue-500 uppercase tracking-[0.2em] mb-6 flex items-center justify-between">
                    <span><i class="fa-solid fa-reply mr-2"></i> Smart Replies</span>
                    <label class="switch transform scale-75"><input type="checkbox" id="autoReply"><span class="slider"></span></label>
                </h3>
                <div class="bg-slate-900/40 border border-dashed border-blue-500/20 rounded-3xl p-5 space-y-4">
                    <input type="text" id="kwInput" placeholder="If user says (hi)" class="w-full bg-slate-900 border border-white/5 rounded-xl px-4 py-3 text-xs input-glow">
                    <textarea id="repInput" placeholder="Bot should reply..." class="w-full bg-slate-900 border border-white/5 rounded-xl px-4 py-3 text-xs input-glow min-h-[80px]"></textarea>
                    <button onclick="addReply()" class="w-full py-3 bg-blue-600/10 text-blue-400 border border-blue-500/20 rounded-xl text-xs font-black uppercase tracking-widest hover:bg-blue-600 hover:text-white transition-all">Add Keyword</button>
                    <div id="replyList" class="space-y-2 mt-4 max-h-48 overflow-y-auto pr-2 custom-scrollbar"></div>
                </div>
            </div>

            <div class="pt-6 space-y-6">
                <button onclick="updateSettings()" id="saveBtn" class="w-full py-5 bg-blue-600 rounded-2xl font-black text-sm uppercase tracking-widest shadow-lg shadow-blue-900/40 hover:bg-blue-500 transition-all flex items-center justify-center space-x-3">
                    <i class="fa-solid fa-cloud-arrow-up"></i>
                    <span>Save & Sync Changes</span>
                </button>

                <div class="rounded-3xl overflow-hidden bg-white/5 border border-white/5 p-2 shadow-inner">
                    <script async="async" data-cfasync="false" src="https://pl28409004.effectivegatecpm.com/04fde588c8c3c4ebc19bb82d26eddcf6/invoke.js"></script>
                    <div id="container-04fde588c8c3c4ebc19bb82d26eddcf6"></div>
                </div>

                <a href="index.html" class="block text-center text-[10px] font-bold text-slate-500 uppercase tracking-widest hover:text-white transition-colors">
                    <i class="fa-solid fa-arrow-left mr-1"></i> Back to Main
                </a>
            </div>

        </div>
    </main>

    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script>
        AOS.init({ duration: 1000, once: true });
        const API_URL = "https://auth-best.vercel.app/api/auth";
        let autoReplies = [];

        function showNotification(message, type = 'info') {
            const container = document.getElementById('notification-container');
            const toast = document.createElement('div');
            const icon = type === 'success' ? 'fa-circle-check' : (type === 'error' ? 'fa-circle-exclamation' : 'fa-circle-info');
            
            toast.className = `toast toast-${type}`;
            toast.innerHTML = `<i class="fa-solid ${icon} ${type === 'success' ? 'text-emerald-400' : 'text-blue-400'}"></i>
                               <span class="text-sm font-medium">${message}</span>`;
            
            container.appendChild(toast);
            setTimeout(() => toast.classList.add('active'), 100);
            setTimeout(() => {
                toast.classList.remove('active');
                setTimeout(() => toast.remove(), 400);
            }, 4000);
        }

        window.onload = async () => {
            setTimeout(() => showNotification("වෙනස්කම් ක්‍රියාත්මක වීමට පැයක පමණ කාලයක් ගතවිය හැක.", "info"), 1000);
            
            const botId = localStorage.getItem('bot_id');
            const botPass = localStorage.getItem('bot_pass');
            if(!botId) { window.location.href = 'login.html'; return; }

            try {
                const res = await fetch(API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ id: botId, password: botPass, action: 'login' })
                });
                const data = await res.json();
                if(data.success) {
                    const s = data.settings;
                    document.getElementById('botName').value = s.botName || '';
                    document.getElementById('ownerName').value = s.ownerName || '';
                    document.getElementById('password').value = s.password || '';
                    document.getElementById('prefix').value = s.prefix || '.';
                    document.getElementById('workType').value = s.workType || 'public';
                    
                    // Fill All Checkboxes
                    document.getElementById('alwaysOnline').checked = s.alwaysOnline === "true";
                    document.getElementById('autoRead').checked = s.autoRead === "true";
                    document.getElementById('readCmd').checked = s.readCmd === "true";
                    document.getElementById('autoStatusReact').checked = s.autoStatusReact === "true";
                    document.getElementById('autoStatusSeen').checked = s.autoStatusSeen === "true";
                    document.getElementById('autoTyping').checked = s.autoTyping === "true";
                    document.getElementById('autoVoice').checked = s.autoVoice === "true";
                    document.getElementById('connectionMsg').checked = s.connectionMsg === "true";
                    document.getElementById('buttons').checked = s.buttons === "true";
                    document.getElementById('antidelete').checked = s.antidelete === "true";
                    document.getElementById('autoReply').checked = s.autoReply === "true";

                    autoReplies = s.autoReplies || [];
                    renderReplies();
                }
            } catch (err) { console.error(err); }
        };

        async function updateSettings() {
            const saveBtn = document.getElementById('saveBtn');
            saveBtn.disabled = true;
            saveBtn.innerHTML = '<i class="fa-solid fa-spinner animate-spin"></i> <span>Syncing...</span>';

            const settingsData = {
                botName: document.getElementById('botName').value,
                ownerName: document.getElementById('ownerName').value,
                password: document.getElementById('password').value,
                prefix: document.getElementById('prefix').value,
                workType: document.getElementById('workType').value,
                alwaysOnline: document.getElementById('alwaysOnline').checked.toString(),
                autoRead: document.getElementById('autoRead').checked.toString(),
                readCmd: document.getElementById('readCmd').checked.toString(),
                autoStatusReact: document.getElementById('autoStatusReact').checked.toString(),
                autoStatusSeen: document.getElementById('autoStatusSeen').checked.toString(),
                autoTyping: document.getElementById('autoTyping').checked.toString(),
                autoVoice: document.getElementById('autoVoice').checked.toString(),
                connectionMsg: document.getElementById('connectionMsg').checked.toString(),
                buttons: document.getElementById('buttons').checked.toString(),
                antidelete: document.getElementById('antidelete').checked.toString(),
                autoReply: document.getElementById('autoReply').checked.toString(),
                autoReplies: autoReplies
            };

            try {
                const res = await fetch(API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ 
                        id: localStorage.getItem('bot_id'), 
                        password: localStorage.getItem('bot_pass'), 
                        action: 'updateSettings', 
                        settings: settingsData 
                    })
                });
                const data = await res.json();
                if(data.success) showNotification("Settings Synced Successfully! ✅", "success");
                else showNotification("Error: " + data.error, "error");
            } catch (err) { showNotification("Sync failed!", "error"); }
            finally { 
                saveBtn.disabled = false;
                saveBtn.innerHTML = '<i class="fa-solid fa-cloud-arrow-up"></i> <span>Save & Sync Changes</span>';
            }
        }

        function renderReplies() {
            const list = document.getElementById('replyList');
            list.innerHTML = autoReplies.map((item, index) => `
                <div class="flex items-center justify-between bg-slate-900 p-3 rounded-xl border border-white/5">
                    <div class="text-[10px]">
                        <span class="text-blue-500 font-bold">${item.keyword}</span>
                        <i class="fa-solid fa-arrow-right mx-2 opacity-30"></i>
                        <span class="text-slate-300">${item.reply.substring(0,25)}...</span>
                    </div>
                    <button onclick="removeReply(${index})" class="text-red-500/50 hover:text-red-500 text-xs"><i class="fa-solid fa-trash-can"></i></button>
                </div>
            `).join('');
        }

        function addReply() {
            const kw = document.getElementById('kwInput').value.trim();
            const rep = document.getElementById('repInput').value.trim();
            if(kw && rep) {
                autoReplies.push({ keyword: kw, reply: rep });
                document.getElementById('kwInput').value = '';
                document.getElementById('repInput').value = '';
                renderReplies();
            }
        }

        function removeReply(index) {
            autoReplies.splice(index, 1);
            renderReplies();
        }

        // Stars Background
        const starsContainer = document.getElementById('stars');
        for (let i = 0; i < 50; i++) {
            const star = document.createElement('div');
            star.className = 'star';
            const size = Math.random() * 2 + 'px';
            star.style.width = size; star.style.height = size;
            star.style.left = Math.random() * 100 + '%';
            star.style.top = Math.random() * 100 + '%';
            star.style.animationDuration = Math.random() * 5 + 5 + 's';
            starsContainer.appendChild(star);
        }
    </script>
</body>
</html>